<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Empreinte de Bois – Portfolio 3D</title>

  <meta name="description"
        content="Portfolio 3D et gravure numérique : sélection de projets, démarche, matériaux et contact." />

  <link rel="stylesheet" href="styles.css" />
</head>

<body>

  <!-- FOND GLOBAL ANIMÉ (FIXE) -->
  <canvas id="background-canvas" aria-hidden="true"></canvas>

  <!-- HEADER STICKY -->
  <header class="site-header" id="site-header">
    <div class="shell shell--row">
      <a href="#top" class="site-logo">
        <span class="site-logo__mark">EB</span>
        <span class="site-logo__text">Empreinte de Bois</span>
      </a>

      <nav class="site-nav" aria-label="Navigation principale">
        <a href="#portfolio">Galerie</a>
        <a href="#process">Démarche</a>
        <a href="#models">Modèles</a>
        <a href="#about">À propos</a>
        <a href="#contact">Contact</a>
      </nav>
    </div>
  </header>

  <main id="top">

    <!-- HERO -->
    <section class="hero">
      <div class="hero__bg"></div>

      <div class="shell hero__content">
        <div class="hero__text">
          <p class="eyebrow">Conception 3D & gravure</p>
          <h1>Donner du relief à la matière.</h1>

          <p class="hero__subtitle">
            Images, volumes et textures au service de la fabrication.
            Un pont entre rendu numérique et pièce physique.
          </p>

          <div class="hero__actions">
            <a href="#portfolio" class="btn btn--primary">Voir la galerie</a>
            <a href="#contact" class="btn btn--ghost">Discuter d’un projet</a>
          </div>

          <p class="hero__hint">Scroll pour explorer ↓</p>
        </div>

        <div class="hero__preview">
          <div class="hero-card">
            <img src="assets/bandeaux/M05/image.png"
                 alt="Carré Bois Sapin"
                 loading="lazy" />
            <div class="hero-card__meta">
              <p class="hero-card__tag">Carré Bois</p>
              <p class="hero-card__title">Support en bois massif</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTENU (inchangé ensuite) -->
    <section class="section" id="portfolio">
      <div class="shell">
        <div class="section__hdr">
          <h2>Galerie</h2>
          <p>Sélection de projets récents.</p>
        </div>
      </div>
    </section>

    <section class="section section--alt" id="process">
      <div class="shell">
        <div class="section__hdr">
          <h2>Démarche</h2>
          <p>Idée → étude → matière.</p>
        </div>
      </div>
    </section>

    <section class="section" id="about">
      <div class="shell">
        <h2>À propos</h2>
        <p>
          Conception 3D et fabrication d’objets gravés, pensés pour exister
          physiquement.
        </p>
      </div>
    </section>

    <section class="section section--alt" id="contact">
      <div class="shell">
        <h2>Contact</h2>
        <p>Un projet ? Une question ?</p>
      </div>
    </section>

  </main>

  <footer class="site-footer">
    <div class="shell site-footer__inner">
      <p>© Empreinte de Bois – Adam</p>
    </div>
  </footer>

  <!-- SCRIPT FOND ANIMÉ -->
  <script>
  /* ===============================
     PARAMÈTRES MODIFIABLES
  =============================== */
  const IMG_GREY = "assets/fond/fond-gris.webp";
  const IMG_GOLD = "assets/fond/fond-dore.webp";

  const MIN_DIAMETER = 50;
  const MAX_DIAMETER = 200;

  const FADE_IN  = 2000; // ms
  const FADE_OUT = 1000; // ms
  const SPAWN_DELAY = 2000;

  const SOFT_EDGE = 0.55;
  const MAX_PULSES = 12;
  /* =============================== */

  const canvas = document.getElementById("background-canvas");
  const ctx = canvas.getContext("2d");

  const maskCanvas = document.createElement("canvas");
  const maskCtx = maskCanvas.getContext("2d");

  const goldCanvas = document.createElement("canvas");
  const goldCtx = goldCanvas.getContext("2d");

  let w, h, dpr;
  let pulses = [];
  let lastSpawn = 0;

  function resize() {
    dpr = Math.min(window.devicePixelRatio || 1, 2);
    w = window.innerWidth;
    h = window.innerHeight;

    for (const c of [canvas, maskCanvas, goldCanvas]) {
      c.width = w * dpr;
      c.height = h * dpr;
    }

    canvas.style.width = w + "px";
    canvas.style.height = h + "px";

    ctx.setTransform(dpr,0,0,dpr,0,0);
    maskCtx.setTransform(dpr,0,0,dpr,0,0);
    goldCtx.setTransform(dpr,0,0,dpr,0,0);
  }

  function load(src) {
    return new Promise(r => {
      const i = new Image();
      i.onload = () => r(i);
      i.src = src;
    });
  }

  function spawn(now) {
    if (pulses.length >= MAX_PULSES) return;
    const d = MIN_DIAMETER + Math.random() * (MAX_DIAMETER - MIN_DIAMETER);
    pulses.push({
      x: Math.random() * w,
      y: Math.random() * h,
      r: d / 2,
      born: now,
      die: now + FADE_IN + FADE_OUT
    });
  }

  function opacity(p, now) {
    const t = now - p.born;
    if (t < 0) return 0;
    if (t < FADE_IN) return t / FADE_IN;
    if (t < FADE_IN + FADE_OUT)
      return 1 - (t - FADE_IN) / FADE_OUT;
    return 0;
  }

  (async function () {
    const grey = await load(IMG_GREY);
    const gold = await load(IMG_GOLD);

    resize();
    window.addEventListener("resize", resize);

    const greyPattern = ctx.createPattern(grey, "repeat");
    const goldPattern = goldCtx.createPattern(gold, "repeat");

    function frame(now) {
      if (now - lastSpawn > SPAWN_DELAY) {
        spawn(now);
        lastSpawn = now;
      }

      pulses = pulses.filter(p => now < p.die);

      ctx.clearRect(0,0,w,h);
      ctx.fillStyle = greyPattern;
      ctx.fillRect(0,0,w,h);

      goldCtx.clearRect(0,0,w,h);
      goldCtx.fillStyle = goldPattern;
      goldCtx.fillRect(0,0,w,h);

      maskCtx.clearRect(0,0,w,h);

      for (const p of pulses) {
        const a = opacity(p, now);
        if (!a) continue;

        const g = maskCtx.createRadialGradient(
          p.x, p.y, p.r * (1 - SOFT_EDGE),
          p.x, p.y, p.r
        );
        g.addColorStop(0, `rgba(255,255,255,${a})`);
        g.addColorStop(1, "rgba(255,255,255,0)");

        maskCtx.fillStyle = g;
        maskCtx.beginPath();
        maskCtx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
        maskCtx.fill();
      }

      goldCtx.globalCompositeOperation = "destination-in";
      goldCtx.drawImage(maskCanvas, 0, 0);
      goldCtx.globalCompositeOperation = "source-over";

      ctx.drawImage(goldCanvas, 0, 0);

      requestAnimationFrame(frame);
    }

    requestAnimationFrame(frame);
  })();
  </script>

</body>
</html>
